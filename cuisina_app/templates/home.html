{% extends 'layout.html' %}
{% block content %}
            <button type="button" title="Add Filter" class="rounded-circle btn fltr-btn  mt-1" data-toggle="modal" data-target="#exampleModalCentered">
                  <i class='fas fa-filter'></i>
            </button>


            <div class="modal fade" id="exampleModalCentered" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenteredLabel" aria-hidden="true">
              <div class="modal-dialog modal-dialog-centered" style="height: fit-content !important;">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalCenteredLabel">Add Filter</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">Ã—</span>
                    </button>
                  </div>
                  <div class="modal-body p-4">
                    {% if fltr == 'All' %}
                      <a style="font-size: 1em !important;" class="home-fltr home-fltr-active" href="{{ url_for('home', fltr ='All') }}">All</a>
                    {% else %}
                      <a style="font-size: 1em !important;" class="home-fltr" href="{{ url_for('home', fltr ='All') }}">View All</a>
                    {% endif %}

                    {% if fltr == 'Western' %}
                      <a style="font-size: 1em !important;" class="home-fltr home-fltr-active" href="{{ url_for('home', fltr ='Western') }}">Western</a>
                    {% else %}
                      <a style="font-size: 1em !important;" class="home-fltr" href="{{ url_for('home', fltr ='Western') }}">Western</a>
                    {% endif %}

                    {% if fltr == 'Asian' %}
                      <a style="font-size: 1em !important;" class="home-fltr home-fltr-active" href="{{ url_for('home', fltr ='Asian') }}">Asian</a>
                    {% else %}
                      <a style="font-size: 1em !important;" class="home-fltr" href="{{ url_for('home', fltr ='Asian') }}">Asian</a>
                    {% endif %}

                    {% if fltr == 'European' %}
                      <a style="font-size: 1em !important;" class="home-fltr home-fltr-active" href="{{ url_for('home', fltr ='European') }}">European</a>
                    {% else %}
                      <a style="font-size: 1em !important;" class="home-fltr" href="{{ url_for('home', fltr ='European') }}">European</a>
                    {% endif %}

                    {% if fltr == 'Filipino' %}
                      <a style="font-size: 1em !important;" class="home-fltr home-fltr-active" href="{{ url_for('home', fltr ='Filipino') }}">Filipino</a>
                    {% else %}
                      <a style="font-size: 1em !important;" class="home-fltr" href="{{ url_for('home', fltr ='Filipino') }}">Filipino</a>
                    {% endif %}
                   
                    
                    
                    
                   
                  </div>
                </div>
              </div>
            </div>

            <button title="Create Post" class="btn create-btn rounded-circle p-0" type="button"data-toggle="modal" data-target="#ModalScrollable">
                  <i class="fa fa-pencil-square-o ml-1 mb-2"></i>
            </button>   
            <div class="modal fade" id="ModalScrollable" tabindex="-1" role="dialog" aria-labelledby="exampleModalScrollableLabel" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
                      <div class="modal-content">
                        <div class="modal-header">
                          <h5 class="modal-title display-4" id="exampleModalCenteredLabel">New Post</h5>
                          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                          </button>
                        </div>
                        <div class="modal-body">
                            <form method="POST" enctype="multipart/form-data">
                                {{ form.csrf_token }}
                          
                                <div class="form-group">
                                    {{ form.title.label(class="form-control-label") }}
                                    {% if form.title.errors %}
                                        {{ form.title(class="form-control form-control-lg is-invalid") }}
                                        <div class="invalid-feedback">
                                            {% for error in form.title.errors %}
                                                <span>{{ error }}</span>
                                            {% endfor %}
                                        </div>
                                    {% else %}
                                        {{ form.title(class="form-control form-control-lg") }}
                                    {% endif %}
                                </div>
                                
                                <div class="form-group">
                                    <div class="row">
                                      {{ form.content.label(class="form-control-label col-2") }}

                                      <div class="col">
                                          {% if form.cuisine.errors %}
                                            {{ form.cuisine(class = "form-control is-invalid mb-3 w-50") }}
                                            <div class="invalid-feedback">
                                                {% for errors in form.cuisine.errors %}
                                                    <span>{{ errors }}</span>
                                                {% endfor %}
                                            </div>
                                          {% else %}
                                            {{ form.cuisine(class="form-control form-control-md mb-3 w-50 ml-auto") }}
                                          {% endif %}
                                      </div>
                                    </div>
                                    
                                    {% if form.content.errors %}
                                        {{ form.content(class="form-control form-control-lg is-invalid") }}
                                        <div class="invalid-feedback">
                                            {% for error in form.content.errors %}
                                                <span>{{ error }}</span>
                                            {% endfor %}
                                        </div>
                                    {% else %}
                                        {{ form.content(class="form-control form-control-lg content") }}
                                    {% endif %}
                                </div>
                                <script class="jsbin" src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
                                  <div class="file-upload">
                                    <button class="file-upload-btn" type="button" onclick="$('.file-upload-input').trigger( 'click' )">Add Image</button>
                                    <div class="image-upload-wrap">
                                      {{ form.upload_picture(class="form-control-file file-upload-input", onchange="readURL(this);", style="display:none;") }}
                                      {% if form.upload_picture.errors %}
                                        {% for error in form.upload_picture.errors %}
                                              <span class="text-danger">{{ error }}</span></br>
                                          {% endfor %}
                                      {% endif %}
                                      <div class="drag-text">
                                        <h3>Select Image</h3>
                                      </div>
                                    </div>
                                    <div class="file-upload-content">
                                      <img class="file-upload-image" src="#" alt="your image" />
                                      <div class="image-title-wrap">
                                        <button type="button" onclick="removeUpload()" class="remove-image">Cancel</button>
                                      </div>
                                    </div>
                                  </div>
    
                                <div class="form-group">
                                    {{ form.submit(class="btn btn-light btn-outline-dark col mt-3") }}
                                </div>
                            </form>
                        </div>
                      </div>
                    </div>
            </div>

            
            {% if recipe %}

            {% else %}
              <div class="post bg-light p-5 mt-2 mb-4" style="font-size: 1em; color: var(--primary-color);">
                <h1 class="display-4" >Start Posting</h1>
                <p style="font-size: 1em; color: var(--primary-color);"><strong>Welcome to Cuisina!</strong> Its time for you to release the kitchen master artist inside of you! Start by clicking the Create Post button <i class="fa fa-pencil-square-o ml-1 mb-2"></i> On the bottom left corner of your screen</p>
              </div>
            {% endif %}
           
            {% for item in recipe %}
             
              <div class="post bg-light p-0 mt-2 mb-4">
                  <article class="media content-section">
                      <div class="media-body">
                        <div class="article-metadata m-3">
                          <img class = "rounded-circle article-img" src="{{ item[11] }}" style=" height:40px; width: 40px;">
                            {% if item[7] == user[0][0] %}
                            <a class="ml-2 article-author" href="{{ url_for('profile', user_id=item[7], fltr='recipes') }}">{{ item[10] }}</a>
                            {% else %}
                            <a class="ml-2 article-author" href="{{ url_for('viewProfile', user_id=item[7], fltr='recipes')  }}">{{ item[10] }}</a>
                            {% endif %}
                            <small class="ml-2 font-weight-bold">{{item[4]}}</small>
                            {% if item[8] == user[0][0] %}
                              <p  class="disabled-btn saved  ml-auto p-2"><i class='far fa-bookmark' style="font-size: 1em"></i></p>
                            {% else %}
                              <p  class="disabled-btn ml-auto p-2"><i class='far fa-bookmark' style="font-size: 1em"></i></p>
                            {% endif %} 
                        </div>
                          {% if item[9] != None %}
                            <div class="col m-0 d-flex p-0 justify-content-center" style="width: 100%;">
                              <a href="{{ url_for('viewpost', recipe_id=item[0]) }}" type="button" class="btn m-0 p-0" style="height: fit-content;">
                                <img src="{{ item[9] }}" alt="" class="article-content align-self-center m-0 p-0 post-img">
                              </a>
                            </div>
                            
                          {% endif %}
                          <small class="text-muted m-0 ml-3">{{ item[3].strftime("%b %d %Y, %I:%M %p")  }}</small><br>
                          <a class="article-title ml-3 font-weight-bold" href="{{ url_for('viewpost', recipe_id=item[0]) }}">{{ item[1] }}</a>
                          <p class="article-content ml-3"style="white-space: pre-wrap;
                            overflow-wrap: break-word;">{{ item[2] | truncate(100) }}</p>
                      </div> 
                    </article>
                    <div class="row ml-3">
                      <div class="star-widget">
                        {% if item[6] == 5 %}
                          <span class="fa fa-star checked"></span>
                          <span class="fa fa-star checked"></span>
                          <span class="fa fa-star checked"></span>
                          <span class="fa fa-star checked"></span>
                          <span class="fa fa-star checked"></span>
                        {% elif item[6] == 4 %}
                         <span class="fa fa-star checked"></span>
                          <span class="fa fa-star checked"></span>
                          <span class="fa fa-star checked"></span>
                          <span class="fa fa-star checked"></span>
                          <span class="fa fa-star"></span>
                        {% elif item[6] == 3 %}
                          <span class="fa fa-star checked"></span>
                          <span class="fa fa-star checked"></span>
                          <span class="fa fa-star checked"></span>
                          <span class="fa fa-star"></span>
                          <span class="fa fa-star"></span>
                        {% elif item[6] == 2 %}
                          <span class="fa fa-star checked"></span>
                          <span class="fa fa-star checked"></span>
                          <span class="fa fa-star"></span>
                          <span class="fa fa-star"></span>
                          <span class="fa fa-star"></span>
                        {% elif item[6] == 1 %}
                         <span class="fa fa-star checked"></span>
                          <span class="fa fa-star"></span>
                          <span class="fa fa-star"></span>
                          <span class="fa fa-star"></span>
                          <span class="fa fa-star"></span>
                        {% else %}
                          <span class="fa fa-star"></span>
                          <span class="fa fa-star"></span>
                          <span class="fa fa-star"></span>
                          <span class="fa fa-star"></span>
                          <span class="fa fa-star"></span>
                        {% endif %} 
                        <small class="ml-2">Average Rating</small>
                      </div>

                      <div class="col ml-4 mb-2 align-self-center">
                        <a class="article-save" href="{{ url_for('viewpost', recipe_id=item[0]) }}">View Comments</a>
                      </div>
                    </div>
              </div>
            {% endfor %}


    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>

    <script>
         function readURL(input) {
            if (input.files && input.files[0]) {

              var reader = new FileReader();

              reader.onload = function(e) {
                $('.image-upload-wrap').hide();

                $('.file-upload-image').attr('src', e.target.result);
                $('.file-upload-content').show();

                $('.image-title').html(input.files[0].name);
              };

              reader.readAsDataURL(input.files[0]);

            } else {
              removeUpload();
            }
          }

          function removeUpload() {
            $('.file-upload-input').replaceWith($('.file-upload-input').clone());
            $('.file-upload-content').hide();
            $('.image-upload-wrap').show();
          }
          $('.image-upload-wrap').bind('dragover', function () {
                  $('.image-upload-wrap').addClass('image-dropping');
              });
              $('.image-upload-wrap').bind('dragleave', function () {
                  $('.image-upload-wrap').removeClass('image-dropping');
          });
    
    </script>
{% endblock content %}