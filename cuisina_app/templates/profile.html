{% extends "layout.html" %}
{% block content %}
           <div class="article profile-sect bg-light">
             <div class="prof-details row p-4">
                    <img class="prof-img rounded-circle article-img" src="{{ user[0][4] }}"  />

                    <div class="col-3 mt-3 names" style="margin-left: 4em">
                      <h1 class="username" style="font-weight:lighter;">{{user[0][1]}}</h1>
                      {% if profile[0][1] %}
                        <p class="m-1 font-weight-bold">{{ profile[0][1] }} {{ profile[0][2] }}</p>
                      {% else %}
                        <p class="m-1 font-weight-bold">PLEASE FINISH SIGN UP BY CLICKING EDIT PROFILE</p>
                      {% endif %}
                        <p class="m-1">{{user[0][2]}}</p>
                    </div>
                    
                    <div class="col-2 m-0 p-0">
                      <button type="button" class="btn m-0 mt-4 edit-btn" type="button" data-toggle="modal" data-target="#ModalScrollable">
                        Edit Profile
                      </button>

                        <div class="modal fade" id="ModalScrollable" tabindex="-1" role="dialog" aria-labelledby="exampleModalScrollableLabel"ria-hidden="true">
                                <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
                                  <div class="modal-content">
                                    <div class="modal-header">
                                      <h5 class="modal-title" id="exampleModalCenteredLabel">Edit Profile</h5>
                                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                      </button>
                                    </div>
                                    <div class="modal-body mt-0 pt-0">
                                        <form method='POST' enctype="multipart/form-data">
                                          {{ form.csrf_token }}
                                          {{ form.hidden_tag() }}

                                          <div class="article account-info mt-0 mb-0 pt-0 justify-content-center">

                                              <div class="row m-1 mb-0 mt-0 p-0">

                                                <div class="file-upload col-4 mt-0 mb-3 p-0">
                                                  <div class="image-upload-wrap rounded-circle article-img mt-0">
                                                    <img class="file-upload-image rounded-circle profile-img" src="{{ user[0][4] }}"  />                        
                                                  </div>
                                                  <div class="file-upload-content">
                                                    <img class="file-upload-image rounded-circle article-img profile-img" src="#" alt="your image" />
                                                  </div>
                                                 
                                                    {{ form.upload_picture(class="form-control-file file-upload-input m-0 p-0", onchange="readURL(this);") }}

                        
                                                </div>

                                              </div>
                                              

                                              <div class="row m-1 mb-0 p-0">
                                                 <div class="form-group col ml-5 m-0 mb-3 p-0">
                                                    {{ form.fname.label(class="form-control-label") }}
                                                    {% if form.fname.errors %}
                                                        {{ form.fname(class="form-control form-control-lg is-invalid") }}
                                                        <div class="invalid-feedback">
                                                            {% for error in form.fname.errors %}
                                                                <span>{{ error }}</span>
                                                            {% endfor %}
                                                        </div>
                                                    {% else %}
                                                        {{ form.fname(class="form-control form-control-lg") }}
                                                    {% endif %}
                                                  </div>


                                                  <div class="form-group col m-0 mb-3 p-0">
                                                    {{ form.lname.label(class="form-control-label") }}
                                                    {% if form.lname.errors %}
                                                        {{ form.lname(class="form-control form-control-lg is-invalid") }}
                                                        <div class="invalid-feedback">
                                                            {% for error in form.lname.errors %}
                                                                <span>{{ error }}</span>
                                                            {% endfor %}
                                                        </div>
                                                    {% else %}
                                                        {{ form.lname(class="form-control form-control-lg") }}
                                                    {% endif %}
                                                  </div>
                                              </div>

                                              <div class="row m-1 mb-0 p-0">
                                                 <div class="form-group col ml-5 m-0 mb-3 p-0">
                                                    {{ form.email.label(class="form-control-label") }}
                                                    {% if form.email.errors %}
                                                        {{ form.email(class="form-control form-control-lg is-invalid") }}
                                                        <div class="invalid-feedback">
                                                            {% for error in form.email.errors %}
                                                                <span>{{ error }}</span>
                                                            {% endfor %}
                                                        </div>
                                                    {% else %}
                                                        {{ form.email(class="form-control form-control-lg") }}
                                                    {% endif %}
                                                  </div>

                                                  <div class="form-group col-4 m-0 mb-3 p-0" style="margin-right: 1.5em !important;">
                                                    {{ form.username.label(class="form-control-label") }}
                                                    {% if form.username.errors %}
                                                        {{ form.username(class="form-control form-control-lg is-invalid") }}
                                                        <div class="invalid-feedback">
                                                            {% for error in form.username.errors %}
                                                                <span>{{ error }}</span>
                                                            {% endfor %}
                                                        </div>
                                                    {% else %}
                                                        {{ form.username(class="form-control form-control-lg") }}
                                                    {% endif %}
                                                  </div>
                                                  
                                              </div>

                                              <div class="row m-1 mb-0 p-0">
                                                <div class="form-group col ml-5 m-0 p-0">
                                                        {{ form.age.label(class="form-control-label") }}
                                                        {% if form.age.errors %}
                                                            {{ form.age(class="form-control form-control-lg is-invalid") }}
                                                            <div class="invalid-feedback">
                                                                {% for error in form.age.errors %}
                                                                    <span>{{ error }}</span>
                                                                {% endfor %}
                                                            </div>
                                                        {% else %}
                                                            {{ form.age(class="form-control form-control-lg") }}
                                                        {% endif %}
                                                </div>
                                                <div class="form-group col-5 m-0 p-0 pl-5">
                                                  {{ form.register_gender.label(class="form-control-label") }}
                                                  {% if form.register_gender.errors %}
                                                    {{ form.register_gender(class = "form-control is-invalid") }}
                                                    <div class="invalid-feedback">
                                                        {% for errors in form.register_gender.errors %}
                                                            <span>{{ errors }}</span>
                                                        {% endfor %}
                                                    </div>
                                                  {% else %}
                                                    {{ form.register_gender(class="form-control form-control-md") }}
                                                  {% endif %}
                                                </div>
                                              </div>
                                             


                                              <div class="form-group mr-5 ml-auto row col-2">
                                                {{ form.submit(class="btn", style="font-size:1em; height:fit-content; width:fit-content; ") }}
                                              </div>
                                              
                                          </div>


                                        </form>
                                    </div>
                                  </div>
                                </div>
                        </div>
                    </div>
                     
                    
                    <div class="align-self-center ml-auto medal col-2 p-0" style="text-align: center;">
                      <h6 class="m-1">Executive Chef</h6>
                      <img class = "rounded-circle article-img" src="{{ url_for('static', filename='rank_images/executive_chef.png') }}"
                          style="height:8em; width: 10em;">
                    </div>  
              </div>
            </div>
            {% if profile[0][1] %}
            <div class="post col row bg-light p-2 mt-2 mb-2" style="color: var(--primary-color); margin-left: 10em;">

              <h3 class="col mt-1" style="color:var(--primary-color);">Posts</h3>
              
  
                <button type="button" class="btn del-btn col-2 h-25 mt-1" data-toggle="modal" data-target="#exampleModalCentered" style="font-size: 1em !important; float: right; border:1px solid var(--primary-color);">
                  <i class='fas fa-filter m-0 mr-1'></i>
                  Filter
                </button>


                <div class="modal fade" id="exampleModalCentered" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenteredLabel" aria-hidden="true">
                  <div class="modal-dialog modal-dialog-centered" style="height: fit-content !important;">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalCenteredLabel">Add Filter</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                          <span aria-hidden="true">Ã—</span>
                        </button>
                      </div>
                      <div class="modal-body">
                        {% if fltr == 'recipes' %}
                          <a href="{{ url_for('profile', user_id=user[0][0], fltr='recipes') }}" style="font-size: 1em !important;"class="home-fltr home-fltr-active">Recipes</a>
                        {% else %}
                          <a href="{{ url_for('profile', user_id=user[0][0], fltr='recipes') }}" style="font-size: 1em !important;"class="home-fltr">Recipes</a>
                        {% endif %}

                        {% if fltr == 'orders' %}
                          <a href="{{ url_for('profile', user_id=user[0][0], fltr='orders') }}" style="font-size: 1em !important;"class="home-fltr home-fltr-active">Order</a>
                        {% else %}
                          <a href="{{ url_for('profile', user_id=user[0][0], fltr='orders') }}" style="font-size: 1em !important;"class="home-fltr">Order</a>
                        {% endif %}
                        
                        
                      
                      </div>
                    </div>
                  </div>
                </div>
            </div>
            {% endif %}
            
            {% for item in recipe %}
             
              <div class="post col bg-light p-0 mt-2 mb-4">
                  <article class="media content-section">
                      <div class="media-body">
                        <div class="article-metadata m-3">
                          <img class = "rounded-circle article-img" src="{{ item[11] }}" style=" height:40px; width: 40px;">
                            {% if item[7] == user[0][0] %}
                            <a class="ml-2 article-author" href="{{ url_for('profile', user_id=item[7], fltr='recipes') }}">{{ item[10] }}</a>
                            {% else %}
                            <a class="ml-2 article-author" href="{{ url_for('viewProfile', user_id=item[7]) }}">{{ item[10] }}</a>
                            {% endif %}
                            <small class="ml-2 font-weight-bold">{{item[4]}}</small>
                            {% if item[8] == user[0][0] %}
                              <p  class="disabled-btn saved  ml-auto p-2"><i class='far fa-bookmark' style="font-size: 1em"></i></p>
                            {% else %}
                              <p  class="disabled-btn ml-auto p-2"><i class='far fa-bookmark' style="font-size: 1em"></i></p>
                            {% endif %} 
                        </div>
                          {% if item[9] != None %}
                            <div class="col m-0 d-flex p-0 justify-content-center" style="width: 100%;">
                              <a href="{{ url_for('viewpost', recipe_id=item[0]) }}" type="button" class="btn m-0 p-0" style="height: fit-content;">
                                <img src="{{ item[9] }}" alt="" class="article-content align-self-center m-0 p-0 post-img">
                              </a>
                            </div>
                            
                          {% endif %}
                          <small class="text-muted m-0 ml-3">{{ item[3].strftime("%b %d %Y, %I:%M %p")  }}</small><br>
                          <a class="article-title ml-3 font-weight-bold" href="{{ url_for('viewpost', recipe_id=item[0]) }}">{{ item[1] }}</a>
                          <p class="article-content ml-3"style="white-space: pre-wrap;
                            overflow-wrap: break-word;">{{ item[2] | truncate(100) }}</p>
                      </div> 
                    </article>
                    <div class="row ml-3">
                      <div class="star-widget">
                        {% if item[6] == 5 %}
                          <span class="fa fa-star checked"></span>
                          <span class="fa fa-star checked"></span>
                          <span class="fa fa-star checked"></span>
                          <span class="fa fa-star checked"></span>
                          <span class="fa fa-star checked"></span>
                        {% elif item[6] == 4 %}
                         <span class="fa fa-star checked"></span>
                          <span class="fa fa-star checked"></span>
                          <span class="fa fa-star checked"></span>
                          <span class="fa fa-star checked"></span>
                          <span class="fa fa-star"></span>
                        {% elif item[6] == 3 %}
                          <span class="fa fa-star checked"></span>
                          <span class="fa fa-star checked"></span>
                          <span class="fa fa-star checked"></span>
                          <span class="fa fa-star"></span>
                          <span class="fa fa-star"></span>
                        {% elif item[6] == 2 %}
                          <span class="fa fa-star checked"></span>
                          <span class="fa fa-star checked"></span>
                          <span class="fa fa-star"></span>
                          <span class="fa fa-star"></span>
                          <span class="fa fa-star"></span>
                        {% elif item[6] == 1 %}
                         <span class="fa fa-star checked"></span>
                          <span class="fa fa-star"></span>
                          <span class="fa fa-star"></span>
                          <span class="fa fa-star"></span>
                          <span class="fa fa-star"></span>
                        {% else %}
                          <span class="fa fa-star"></span>
                          <span class="fa fa-star"></span>
                          <span class="fa fa-star"></span>
                          <span class="fa fa-star"></span>
                          <span class="fa fa-star"></span>
                        {% endif %} 
                        <small class="ml-2">Average Rating</small>
                      </div>

                      <div class="col ml-4 mb-2 align-self-center">
                        <a class="article-save" href="{{ url_for('viewpost', recipe_id=item[0]) }}">View Comments</a>
                      </div>
                    </div>
              </div>
            {% endfor %}
            {% if not recipe and profile[0][1] %}
             <div class="post bg-light p-5 mt-2 mb-4" style="color: var(--primary-color); margin-left: 10em;">
               <a href='/filter' class="btn">Go to Food Feed and Post Now</a>
             </div>
            {% elif not profile[0][1] %}
              <div class="post bg-light p-5 mt-2 mb-4" style="color: var(--primary-color); margin-left: 10em;">
                <h1 class="display-4" >Finish Sign Up</h1>
                <p style="font-size: 1em;"><strong>Welcome to Cuisina!</strong> In order for you to finally show the Gordon Ramsay within you
                    please kindly Finish Signing Up</p>
             </div>
            {% endif %}

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>

    <script>
         function readURL(input) {
            if (input.files && input.files[0]) {

              var reader = new FileReader();

              reader.onload = function(e) {
                $('.image-upload-wrap').hide();

                $('.file-upload-image').attr('src', e.target.result);
                $('.file-upload-content').show();

                $('.image-title').html(input.files[0].name);
              };

              reader.readAsDataURL(input.files[0]);

            } else {
              removeUpload();
            }
          }

          function removeUpload() {
            $('.file-upload-input').replaceWith($('.file-upload-input').clone());
            $('.file-upload-content').hide();
            $('.image-upload-wrap').show();
          }
          $('.image-upload-wrap').bind('dragover', function () {
                  $('.image-upload-wrap').addClass('image-dropping');
              });
              $('.image-upload-wrap').bind('dragleave', function () {
                  $('.image-upload-wrap').removeClass('image-dropping');
          });
    
    </script>
               
                
{% endblock %}

